This is somewhat untested but is believed to work.

